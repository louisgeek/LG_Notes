AMS

- Activity Manager Service







Activity的启动过程：（AMS怎么知道你要启动的是哪个页面）
 这个答的不好，重新总结一下：
 答：Activity启动是通过startActivity方法进行的，最后会通过Instrumentation对象调用execStartActivity方法，Instrumentation用来管理applicaiton及Activity的生命周期。Instrumentation最终通过binder通信将信息给到AMS，AMS在startActivity时，AMS把启动Activity的功能实现转移到ATMS中，ATMS用于管理Activity及其容器（任务、堆栈、显示等）的系统服务。之后通过getActivityStartController().obtainStarter获取一个ActivityStarter实例，ActivityStarter通过startActivity时，会初始化一个ActivityRecord对象实例，它可以说是一个Activity，存储了Activity的所有信息。之后如果有需要还会创建一个TaskRecord（任务栈），加入到ActivityStack（Activity栈），之后将ActivityRecord加入到TaskRecord栈顶位置。AMS在初始化的时候会会创建一个ActivityStackSupervisor，维护了两个栈对象：mHomeStack、mFocusedStack()，管理着ActivityStack（Activity栈）、ActivityStack管理着TaskRecord任务栈、TaskRecord管理着ActivityRecord。
 AMS就是通过ActivityStackSupervisor来直接或间接管理ActivityStack、TaskRecord、ActivityRecord，从ActivityRecord中就能得知要启动的Activity是哪一个，知道要启动的Activity是哪个包下的。
 Instrumentation通过Binder与AMS通信，知道了要启动哪个页面，之后AMS又通过binder将启动的操作交给ActivityThread，之后执行scheduleTransaction方法，通过mH（Handler）来切换线程，最终执行handleLaunchActivity方法去启动Activity。真正启动方法是：performLaunchActivity方法，通过ActivityClientRecord获取ActivityInfo对象，实例话具体的Activity实例、ContextImpl实例等等，之后执行生命周期的一些方法。



 