# 内存优化



用 StringBuilder、StringBuffer 代替 String

用 ArrayMap、SparseArray 替换 HashMap



## 内存泄漏

指某块内存在使用完毕之后，还被其他对象引用着，导致GC回收不了。（**生命周期长的对象引用生命周期短的对象**）

- 集合类泄漏(集合一直引用着被添加进来的元素对象)
- 单例/静态变量造成的内存泄漏(生命周期长的持有了生命周期短的引用)
- 匿名内部类/非静态内部类
- 资源未关闭造成的内存泄漏
  - 网络,文件等流忘记关闭
  - 手动注册广播时，退出时忘记 unregisterReceiver()
  - Service 执行完成后忘记 stopSelf()
  - EventBus 等观察者模式的框架忘记手动解除注册





## 内存溢出

指应用内存超出Android系统赋予给每一个应用最大容量的限制。（**OutOfMemory**）

- 一定量的内存泄漏增长导致的 OOM

- 大量使用Bitmap 导致的 OOM

- 内存中存在大量的强引用对象；



1.适合选择不同的引用方式创建对象（强、软、弱、虚）；
2.在必要时块合理的按模划分**多进程（android:process=":xxx"）**开发，分散内存占用；
3.内存对象的重复利用；
4.优化布局层次，重用，需要时加载ViewStub，减少内存消耗；



## 内存抖动

在短时间内有大量的对象被创建或者被回收的现象。（**循环种大量创建对象、回收内存GC**）
